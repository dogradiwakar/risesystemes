<!doctype html>
<html amp lang="en">
  
<!-- Mirrored from www.redapt.com/blog/utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges?hs_amp=true by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 23 Dec 2020 06:50:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Utilizing Vault by HashiCorp to Navigate CCPA Challenges</title>
    <link rel="canonical" href="utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges.html" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <meta name="author" content="Michael Little">

    <meta name="description" content="On the first of January 2020, the California Consumer Privacy Act (CCPA) went into effect, placing new burdens on organizations that do business in or with residents of California. Which means a whole lot of organizations are under pressure to meet new regulations.  ">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta name="generator" content="HubSpot">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Utilizing Vault by HashiCorp to Navigate CCPA Challenges",
        "datePublished": "2020-01-28T18:57:16Z",
        "dateModified": "2020-08-26T20:49:12.729Z",
        "mainEntityOfPage": "https://www.redapt.com/blog/utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges",
        "author": {
          "@type": "Person",
          "name": "Michael Little"
        },
        "image": {
         "@type": "ImageObject",
        
          
          "width": 1920,
          
          
          "height": 410,
          
          "url": "https://cdn2.hubspot.net/hubfs/6151115/Banner.png"
        
        },
        "publisher" : {
          "@type": "Organization",
          "logo": {
            "@type": "ImageObject",
            
            "url": "https://cdn2.hubspot.net/hubfs/6151115/Redapt_August2019/Images/logo.svg",
            "width": 60.000004,
            "height": 60.0
            
          },
          "name": "Insights"
        }
      }
    </script>
    <script async custom-element="amp-analytics" src="../../cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript>
      <style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style>
    </noscript>
  <style amp-custom>
      body {
        color: #404040;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 18px;
        line-height: 1.6;
      }

      .hs-page-width-normal {
        box-sizing: content-box;
        margin: 0 auto;
        padding: 0 5vw 5vw;
      }

      .info {
        font-size: 14px
      }

      h1 {
        color: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 26px;
        line-height: 1.5;
        font-weight: 600;
      }

      h1 a {
        color: #404040;
      }

      h2 {
        color: #404040;
        font-size: 22px;
        line-height: 38px;
      }

      a {
        color: #416bb3;
        text-decoration: none;
      }

      .logo-header-text {
        color: #1e1e1e;
        font-size: 36px;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        line-height: 2.0;
        font-weight: bold;
        vertical-align: text-bottom;
      }

      .hs-page-width-normal {
        padding: 5vw;
      }

      .iframe-placeholder {
        background-color: #bbb;
      }

      .header-banner {
        padding: 3vw 1vw;
        border-color: #dcdcdc;
        border-bottom-style: solid;
        border-bottom-width: thin;
        background-color: #ffffff;
        color: #1e1e1e;
        text-align: center;
      }

      .full-link {
        text-align: center;
      }

      .full-link a {
        border: 1px solid #dcdcdc;
        background-color: transparent;
        color: #416bb3;
        cursor: pointer;
        display: block;
        font-size: 14px;
        line-height: 18px;
        margin: 0 auto;
        max-width: 200px;
        padding: 11px 16px;
        text-decoration: none;
        width: 50%;
      }

    </style></noscript>
    <script async src="../../cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <div class="row-fluid">
      <div class="header-banner">
        <a class="blog-link" href="../blog.html">
        
          <span class="logo">
            <amp-img src="https://cdn2.hubspot.net/hubfs/6151115/Redapt_August2019/Images/logo.svg" height="60.0" width="60.000004" alt="logo"></amp-img>
          </span>
        
          <span class="logo-header-text">Insights | Redapt</span>
         </a>
      </div>  
      <div class="hs-page-width-normal">
        <div class="post-header">
          <h1><a href="utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges.html">Utilizing Vault by HashiCorp to Navigate CCPA Challenges</a></h1>
        </div>
        <div class="info">
          <span> Written by <a class="author-link" href="author/michael-little.html">Michael Little</a> | Jan 28, 2020 6:57:16 PM </span>
        </div>
        <div class="blog-section">
          <span><p><span>On the</span><span>&nbsp;first of January&nbsp;</span><span>2020, the</span><span>&nbsp;</span><a href="https://en.wikipedia.org/wiki/California_Consumer_Privacy_Act"><span>California Consumer Privacy Act</span></a><span>&nbsp;(</span><span>CCPA</span><span>)&nbsp;</span><span>went into effect,&nbsp;</span><span>plac</span><span>ing</span><span>&nbsp;new burdens on organizations</span><span>&nbsp;that do business in or with residents of California. Which means&nbsp;</span><span>a whole lot of&nbsp;</span><span>organizations</span><span>&nbsp;are under pressure to meet new regulations</span><span>.&nbsp;</span><span>&nbsp;</span></p>
<p><span>But, d</span><span>idn't we just go through this with&nbsp;</span><span>General Data Protection Regulation (</span><span>GDPR</span><span>)</span><span>?</span><span>&nbsp;</span></p>
<p><span>While some of the requirements brought to us by the European Union's GDPR</span><span>&nbsp;do&nbsp;</span><span>overlap with CCPA, GDPR compliance isn't enough to protect you</span><span>r organization</span><span>&nbsp;</span><span>in regard to</span><span>&nbsp;CCPA.</span><span>&nbsp;</span></p>
<p><span>Let’s review the basics of what CCPA allows consumers:</span><span>&nbsp;</span></p>
<ul>
<li><span>t</span><span>o k</span><span>now what personal data&nbsp;</span><span>is</span><span>&nbsp;being collected</span><span>&nbsp;</span></li>
<li><span>to k</span><span>now</span><span>&nbsp;that</span><span>&nbsp;data is being stored securely</span><span>&nbsp;</span></li>
<li><span>to k</span><span>now if&nbsp;</span><span>that&nbsp;</span><span>data is being sold or disclosed</span><span>&nbsp;</span></li>
<li><span>to o</span><span>bject to the sale of that data</span><span>&nbsp;</span></li>
<li><span>to have</span><span>&nbsp;access to their personal data</span><span>&nbsp;</span></li>
<li><span>to r</span><span>equest that a</span><span>n organization</span><span>&nbsp;delete th</span><span>eir</span><span>&nbsp;data</span><span>&nbsp;</span></li>
<li><span>to avoid</span><span>&nbsp;discriminat</span><span>ion</span><span>&nbsp;</span><span>relevant to&nbsp;</span><span>exercising their rights</span><span>&nbsp;</span></li>
</ul>
<p><span>Many of the p</span><span>rovisions of the CCPA can</span><span>&nbsp;simply</span><span>&nbsp;be&nbsp;</span><span>adhered to</span><span>&nbsp;</span><span>through</span><span>&nbsp;changes to</span><span>&nbsp;organizational</span><span>&nbsp;policies or</span><span>&nbsp;disclaimers issued on an organization</span><span>’s website</span><span>. Th</span><span>at said, a handful of</span><span>&nbsp;provisions&nbsp;</span><span>are</span><span>&nbsp;best addressed using technology.</span><span>&nbsp;</span></p>
<p><span>To ensure that data is store</span><span>d</span><span>&nbsp;securely, encrypt</span><span>ion</span><span>,&nbsp;</span><span>both in transit and at rest</span><span>,&nbsp;</span><span>can be&nbsp;</span><span>utilized—however,&nbsp;</span><span>build</span><span>ing</span><span>&nbsp;an encryption scheme yourself</span><span>&nbsp;can be a challenge.</span><span>&nbsp;</span></p>
<p><span>Additionally, h</span><span>ow can you ensure that the data hasn't been accessed inappropriately or disclosed to outside parties? By logging each access attempt and analyzing those logs</span><span>,</span><span>&nbsp;you</span><span>’ll make certain</span><span>&nbsp;that only approved processes or people&nbsp;</span><span>can</span><span>&nbsp;see</span><span>&nbsp;or&nbsp;</span><span>use the data.</span><span>&nbsp;</span></p>
<p><span>Deleting data&nbsp;</span><span>upo</span><span>n request m</span><span>ight</span><span>&nbsp;sound&nbsp;</span><span>straight</span><span>&nbsp;forward</span><span>&nbsp;</span><span>but what about&nbsp;</span><span>all</span><span>&nbsp;the backups?&nbsp;</span><span>Will&nbsp;</span><span>you</span><span>&nbsp;</span><span>have</span><span>&nbsp;to scour every S3 bucket or backup tape to&nbsp;</span><span>safeguard</span><span>&nbsp;that the data has been completely removed? If you encrypt each record with a unique key, you can functionally delete all copies of a record by deleting that key.</span><span> Much simpler, right?</span><span>&nbsp;</span></p>
<p><span>HashiCorp's</span><span>&nbsp;Vault is a drop-in solution to these challenges and more. Let's&nbsp;</span><span>drive into</span><span>&nbsp;three specific parts of CCPA and&nbsp;</span><span>how&nbsp;</span><span>Vault can be&nbsp;</span><span>utilized</span><span>&nbsp;to address these challenges.</span><span>&nbsp;</span></p>
<h3><strong>Requirement</strong></h3>

<div><strong> SEC. 4. Section 1798.100 of the Civil Code is amended to read: </strong></div>
<div>&nbsp;</div>
<div><strong>(f) A business that collects a consumer's personal information shall implement reasonable security procedures and practices appropriate to the nature of the personal information to protect the personal information from unauthorized or illegal access.<br></strong><span></span></div>
<h4>&nbsp;</h4>
<h3><strong>Solution</strong></h3>
<p>Vault Security Barrier</p>
<p>The storage backends used by Vault are untrusted by design. Vault uses a security barrier for all requests made to the backend. Vault’s cryptographic barrier encrypts all information in transit and at rest via the cryptographically secure aes-256 algorithm. Depending on the backend used, Vault may communicate with the backend over TLS to provide an added layer of security. In some cases, such as a file backend, this is not applicable. Because storage backends are untrusted, an eavesdropper would only gain access to encrypted data (even if communication with the backend was intercepted).</p>
<p><amp-img src="../hs-fs/hubfs/Barrier_Graphicdda6.png?width=1920&amp;name=Barrier_Graphic.png" alt="Barrier_Graphic" width="1920.0" srcset="https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=960&amp;name=Barrier_Graphic.png 960w, https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=1920&amp;name=Barrier_Graphic.png 1920w, https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=2880&amp;name=Barrier_Graphic.png 2880w, https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=3840&amp;name=Barrier_Graphic.png 3840w, https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=4800&amp;name=Barrier_Graphic.png 4800w, https://www.redapt.com/hs-fs/hubfs/Barrier_Graphic.png?width=5760&amp;name=Barrier_Graphic.png 5760w" height="1080.0" layout="responsive"></amp-img></p>
<h3><strong>Encryption as a Service</strong></h3>
<p>The transit secrets engine handles cryptographic functions on data in-transit. Vault doesn't store the data sent to the secrets engine. It can also be viewed as "Cryptography as a Service" or "Encryption as a Service". Furthermore, Vault’s Transit secrets engine allows for encryption/decryption/hmac workflows, as well as signing and verification, abstracting the complexity around maintaining encryption keys, and allowing users and organizations to retain control over them inside Vault’s cryptographic barrier. The primary use case for transit is to encrypt data from applications while still storing that encrypted data in some primary data store. This relieves the burden of proper encryption/decryption from application developers and pushes the burden onto the operators of Vault.</p>
<h3><strong><amp-img src="../hs-fs/hubfs/EaaS207f.png?width=812&amp;name=EaaS.png" alt="EaaS" width="1920.0" srcset="https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=406&amp;name=EaaS.png 406w, https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=812&amp;name=EaaS.png 812w, https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=1218&amp;name=EaaS.png 1218w, https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=1624&amp;name=EaaS.png 1624w, https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=2030&amp;name=EaaS.png 2030w, https://www.redapt.com/hs-fs/hubfs/EaaS.png?width=2436&amp;name=EaaS.png 2436w" height="1080.0" layout="responsive"></amp-img></strong></h3>
<h3><strong>Requirement</strong></h3>
<p><strong>SEC. 5. Section 1798.105 of the Civil Code is amended to read: </strong></p>
<p><strong>1798.105. Right to Delete Personal Information </strong></p>
<p><strong>1798.105. (a) A consumer shall have the right to request that a business delete any personal information about the consumer which the business has collected from the consumer.</strong></p>
<h3><strong>Solution</strong></h3>
<p>Vault’s Transit backend supports deriving a unique encryption key for each citizen. Using derived convergent is extremely powerful as it offers several benefits to your organization. Key derivation is supported, which allows the same key to be used for multiple purposes by deriving a new key based on a user-supplied context value.</p>
<p>In this mode, Vault encrypts each row in each table of the database with a unique encryption key. Even if an attacker were able to access the raw data, each row of the database is encrypted with a unique, high-entropy key. Also, the database never sees a plaintext value. Why do we need derived encryption? When 1798.105. (a) is invoked, the derived key is then removed and data is effectively cryptoshreded. If any ciphertext was lost or stolen they would essentially become useless to a would be attacker as they now have no means of finding the encryption key. Enable the transit secrets engine by executing the following command:</p>
<p>&nbsp;</p>
<pre><code></code><span> <code>
$ vault secrets enable transit

</code></span></pre>
<p>&nbsp;</p>
<p>By default, the secrets engine will mount at the name of the engine. Now, create an encryption key ring named "ccpa" by executing the following command:</p>
<p>&nbsp;</p>
<pre><code></code><span> <code>
$ vault write -f transit/keys/ccpa
  
</code></span></pre>
<p>&nbsp;</p>
<p><code></code></p>
<p>Create encryption key with convergent encryption option in Vault's UI derived key.<code></code></p>
<h3><strong>Requirement</strong></h3>
<p><strong>SEC. 13. Section 1798.140 of the Civil Code is amended to read: </strong></p>
<p><strong>1798.140. Definitions </strong></p>
<p><strong>(1) Auditing related to a current interaction with the consumer and concurrent transactions, including, but not limited to, counting ad impressions to unique visitors, verifying positioning and quality of ad impressions, auditing compliance with this specification and other standards, providing analytic services, or providing similar services on behalf of the business, service provider, or contractor.</strong></p>
<h3><strong>Solution</strong></h3>
<p>Vault’s audit log maps actions to entities to track data breach taxonomy, patterns of access, and who is accessing what.</p>
<p>Audit devices are the components in Vault that responsible for managing audit logs. Every request to Vault and response from Vault goes through the configured audit devices. This provides a simple way to integrate Vault with multiple audit logging destinations of different types.</p>
<p>The generated audit log contains every authenticated interaction with Vault including errors. There is an audit log entry for each request and its response, a compressed JSON object that looks like this:</p>
<pre><code>
{
 	"time": "2019-11-05T00:40:27.638711Z",
 	"type": "request",
 	"auth": {
 		"client_token": "hmacsha256:6291b17ab99eb5bf3fd44a41d3a0bf0213976f26c72d12676b33408459a89885",
 		"accessor": "hmacsha256:2630a7b8e996b0c451db4924f32cec8793d0eb69609f777d89a5c8188a742f52",
 		"display_name": "root",
 		"policies": [
 		"root"
 		],
 		"token_policies": [
 		"root"
 		],
 		"token_type": "service"
 	},
 	"request": {
 		"id": "9adb5544-637f-3d42-9459-3684f5d21996",
 		"operation": "update",
 		"client_token": "hmacsha256:6291b17ab99eb5bf3fd44a41d3a0bf0213976f26c72d12676b33408459a89885",
 		"client_token_accessor": "hmacsha256:2630a7b8e996b0c451db4924f32cec8793d0eb69609f777d89a5c8188a742f52",
 		"namespace": {
 		"id": "root"
 		},
		ccpa.md 11/29/2019
		4 / 5
 		"path": "sys/policies/acl/admin",
 		"data": {
 		"policy": "hmacsha256:212744709e5a643a5ff4125160c26983f8dab537f60d166c2fac5b95547abc33"
 		},
 		"remote_address": "127.0.0.1"
 	}
}
{
 	"time": "2019-11-05T00:40:27.641524Z",
 	"type": "response",
 	"auth": {
 		"client_token": "hmacsha256:6291b17ab99eb5bf3fd44a41d3a0bf0213976f26c72d12676b33408459a89885",
 		"accessor": "hmacsha256:2630a7b8e996b0c451db4924f32cec8793d0eb69609f777d89a5c8188a742f52",
 		"display_name": "root",
 		"policies": [
 		"root"
 		],
 		"token_policies": [
 		"root"
 		],
 		"token_type": "service"
 	},
 		"request": {
 		"id": "9adb5544-637f-3d42-9459-3684f5d21996",
 		"operation": "update",
 		"client_token": "hmacsha256:6291b17ab99eb5bf3fd44a41d3a0bf0213976f26c72d12676b33408459a89885",
 		"client_token_accessor": "hmacsha256:2630a7b8e996b0c451db4924f32cec8793d0eb69609f777d89a5c8188a742f52",
 		"namespace": {
 		"id": "root"
 		},
		"path": "sys/policies/acl/admin",
 		"data": {
 		"policy": "hmacsha256:212744709e5a643a5ff4125160c26983f8dab537f60d166c2fac5b95547abc33"
 		},
 		"remote_address": "127.0.0.1"
 	},
 	"response": {}
}
  
</code></pre>
<p>&nbsp;</p>
<p>The following command enables the audit device, file at the file/path. The output logs are stored in the /vault/vault-audit.log file.</p>
<span><span><span><code>$ vault audit enable file file_path=/vault/vault-audit.log
  
</code></span></span></span>
<p>&nbsp;</p>
<p>Success! Enabled the file audit device at: <strong>file/</strong>.</p>
<h3><strong>References</strong></h3>
<ul>
<li>CCPA version 2</li>
<li><a href="https://www.vaultproject.io/docs/internals/architecture.html">https://www.vaultproject.io/docs/internals/architecture.html</a></li>
<li><a href="https://www.vaultproject.io/docs/internals/security.html">https://www.vaultproject.io/docs/internals/security.html</a></li>
<li><a href="https://learn.hashicorp.com/vault/encryption-as-a-service/eaas-transit">https://learn.hashicorp.com/vault/encryption-as-a-service/eaas-transit</a></li>
<li><a href="https://www.vaultproject.io/docs/secrets/transit/index.html">https://www.vaultproject.io/docs/secrets/transit/index.html</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p><amp-analytics type="googleanalytics"><script type="application/json">{
  "vars": {
    "account": "UA-2098698-1"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    }
  }
}
</script></amp-analytics></span>
        </div>
        <div class="full-link">
          <a href="utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges.html">View full post</a>
        </div>
      </div>
    </div>
    
    <amp-pixel src="../../track.hubspot.com/__ptq1f22.gif?cd=SCREEN_COLOR_DEPTH-bit&amp;cs=DOCUMENT_CHARSET&amp;ln=BROWSER_LANGUAGE&amp;sd=AVAILABLE_SCREEN_WIDTHxAVAILABLE_SCREEN_HEIGHT&amp;v=1.1&amp;iaa=1&amp;k=1&amp;ccu=CANONICAL_URL&amp;r=DOCUMENT_REFERRER&amp;ct=blog-post&amp;t=Utilizing+Vault+by+HashiCorp+to+Navigate+CCPA+Challenges&amp;pi=23650517017&amp;a=6151115&amp;nc=true&amp;cgi=11355233533&amp;vi=CLIENT_ID(hubspotutk)&amp;ai=CLIENT_ID(amputk)">
    </amp-pixel>
    
  </body>

<!-- Mirrored from www.redapt.com/blog/utilizing-vault-by-hashicorp-to-navigate-ccpa-challenges?hs_amp=true by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 23 Dec 2020 06:50:14 GMT -->
</html>
